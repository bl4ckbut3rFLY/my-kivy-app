<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <script>
        async function loadClients() {
            const res = await fetch("/clients");
            const data = await res.json();
            const list = document.getElementById("clients");
            list.innerHTML = "";
            data.clients.forEach(id => {
                const item = document.createElement("li");
                item.textContent = id;
                item.onclick = () => selectClient(id);
                list.appendChild(item);
            });
        }

        async function selectClient(id) {
            document.getElementById("selected").textContent = id;
            const res = await fetch(`/logs/${id}`);
            const data = await res.json();
            document.getElementById("logs").textContent = data.logs.join("\n");
        }

        async function sendCommand() {
            const id = document.getElementById("selected").textContent;
            const cmd = document.getElementById("command").value;
            await fetch(`/send/${id}`, {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({command: cmd})
            });
        }

        window.onload = loadClients;
    </script>
</head>
<body>
    <h1>Dashboard</h1>
    <ul id="clients"></ul>
    <h2>Selected: <span id="selected">None</span></h2>
    <textarea id="logs" rows="10" cols="50" readonly></textarea><br>
    <input id="command" placeholder="Enter command">
    <button onclick="sendCommand()">Send</button>
</body>
</html>
